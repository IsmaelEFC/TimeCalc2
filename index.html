<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Meta para controlar el color de la barra de estado del navegador -->
  <meta name="theme-color" id="theme-color-meta" content="#0d1b2a">

  <title>Calculadora de Desfases</title>

  <!-- Dependencias CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap" />
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">

  <!-- Dependencias JavaScript -->
  <!-- jQuery y jQuery UI deben cargarse antes de script.js -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <!-- Localización en español para jQuery UI -->
  <script src="https://code.jquery.com/ui/1.12.1/i18n/datepicker-es.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/locale/es.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body>
  <div class="container">
    <header class="my-4 text-center">
      <div id="theme-switcher" class="theme-switcher">
        <i class="bi bi-moon-fill"></i>
      </div>
      <h1>Calculadora de Desfases</h1>
      <p class="lead">por Ismael Flores <span class="text-muted">2023</span></p>
    </header>

    <main>
      <section id="calculo-desfase" class="mb-4 p-3 border rounded">
        <h2 class="h4 mb-3">1. Calcular Desfase Inicial</h2>
        <fieldset>
          
          <!-- Sección 1: Ingreso de Fecha y Hora DVR -->
          <div class="mb-3">
            <label for="fechaDVR" class="form-label">Seleccione fecha DVR</label>
            <input type="text" id="fechaDVR" class="form-control" placeholder="dd/mm/yyyy" />
          </div>
          <div class="mb-3">
            <label for="horaDVR" class="form-label">Ingrese hora DVR</label>
            <input type="text" id="horaDVR" class="form-control timepicker" placeholder="HH:mm:ss" autocomplete="off" inputmode="numeric" />
          </div>
        </fieldset>

        <fieldset class="mt-3">
          
          <!-- Sección 2: Ingreso de Fecha y Hora Oficial -->
          <div class="mb-3">
            <label for="fechaOficial" class="form-label">Seleccione fecha OFICIAL</label>
            <input type="text" id="fechaOficial" class="form-control" placeholder="dd/mm/yyyy" />
          </div>
          <div class="mb-3">
            <label for="horaOficial" class="form-label">Ingrese hora OFICIAL</label>
            <input type="text" id="horaOficial" class="form-control timepicker" placeholder="HH:mm:ss" autocomplete="off" inputmode="numeric" />
          </div>
        </fieldset>

        <!-- Botón para Calcular Desfase -->
        <div class="text-end mt-3">
          <button id="calcularDesfaseBtn" class="btn btn-outline-primary">Calcular desfase</button>
        </div>

        <!-- Resultados del Desfase -->
        <div class="result mt-3">
          <p id="resultado" aria-live="polite"></p>
          <p id="mensaje" aria-live="polite"></p>
        </div>
      </section>

      <section id="calculo-hora-dvr" class="mb-4 p-3 border rounded">
        <h2 class="h4 mb-3">2. Calcular Hora DVR (Orienta búsqueda)</h2>
        <button class="btn btn-outline-warning w-100" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHoraDvr" aria-expanded="false" aria-controls="collapseHoraDvr">
          Mostrar/Ocultar Sección
        </button>
        <div class="collapse mt-3" id="collapseHoraDvr">
          <fieldset>
            
            <div class="mb-3">
              <label for="nuevaFecha" class="form-label">Seleccione fecha de ocurrencia del hecho:</label>
              <input type="text" id="nuevaFecha" class="form-control" placeholder="dd/mm/yyyy" />
            </div>
            <div class="mb-3">
              <label for="nuevaHoraOficial" class="form-label">Ingrese hora oficial registrada:</label>
              <input type="text" id="nuevaHoraOficial" class="form-control timepicker" placeholder="HH:mm:ss" autocomplete="off" inputmode="numeric" />
            </div>
          </fieldset>
          <div class="text-end mt-3">
            <button id="calcularDvrTimeBtn" class="btn btn-outline-info">Calcular Hora DVR</button>
          </div>
          <p id="nuevoResultado" class="mt-3" aria-live="polite"></p>
        </div>
      </section>

      <section id="calculo-hora-oficial" class="mb-4 p-3 border rounded">
        <h2 class="h4 mb-3">3. Calcular Hora Oficial</h2>
        <button class="btn btn-outline-warning w-100" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHoraOficial" aria-expanded="false" aria-controls="collapseHoraOficial">
          Mostrar/Ocultar Sección
        </button>
        <div class="collapse mt-3" id="collapseHoraOficial">
          <fieldset>
            
            <div class="mb-3">
              <label for="nuevaFecha2" class="form-label">Seleccione fecha del DVR:</label>
              <input type="text" id="nuevaFecha2" class="form-control" placeholder="dd/mm/yyyy" />
            </div>
            <div class="mb-3">
              <label for="nuevaHoraOficial2" class="form-label">Ingrese hora DVR:</label>
              <input type="text" id="nuevaHoraOficial2" class="form-control timepicker" placeholder="HH:mm:ss" autocomplete="off" inputmode="numeric" />
            </div>
          </fieldset>
          <div class="text-end mt-3">
            <button id="calcularOfficialTimeBtn" class="btn btn-outline-info">Calcular Hora OFICIAL</button>
          </div>
          <p id="nuevoResultado2" class="mt-3" aria-live="polite"></p>
        </div>
      </section>
    </main>
  </div>

  <!-- Tu script principal -->
  <script src="script.js"></script>

  <!-- Registro del Service Worker (al final del body para no bloquear el renderizado) -->
  <script>
    window.addEventListener('load', () => {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js')
          .then(() => console.log("Service Worker registrado con éxito."))
          .catch(err => console.error("Error al registrar Service Worker:", err));
      }
    });
  </script>
</body>
</html>
